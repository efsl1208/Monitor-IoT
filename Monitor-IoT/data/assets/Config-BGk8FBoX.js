import{c as A,h as x,d as C,e as T,a as S,y as w,u as e,b as N,B as k,f as q,E as G,g as U,i as V}from"./index-mqe2bF40.js";/**
 * @license lucide-preact v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=A("MoveLeft",[["path",{d:"M6 8L2 12L6 16",key:"kyvwex"}],["path",{d:"M2 12H22",key:"1m8cig"}]]);/**
 * @license lucide-preact v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=A("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-preact v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=A("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),L=/^((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)\.?\b){4}$/,P="bg-red-50 border border-red-500 text-red-900 placeholder-red-700 text-sm rounded-lg focus:ring-red-500 dark:bg-gray-700 focus:border-red-500 block w-full p-2.5 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500",I="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",W=async r=>await(await fetch(k+"config?seccion=red",{headers:{Authorization:`Bearer ${r}`}})).json(),J=async(r,a)=>{if(!a)return;let t=new FormData;return Object.keys(r).forEach(o=>{t.append(o,r[o])}),t.append("seccion","red"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function K(){const[r,a]=x({mode:"1",ssid:"",pass:"",ip:"",gateway:""}),[t,o]=x(!1),[s,i]=x({ssid:!1,pass:!1,ip:!1,gateway:!1,fetch:!1}),{token:n,setToken:g}=C(T),[h,m]=x({text:"",type:""}),b=S(null),{ssid:d,pass:l,ip:u,gateway:f,mode:c}=r;w(async()=>{try{let v=await W(n);if(!v){m({text:"Error al cargar la configuración. Inténtelo de nuevo.",type:"error"});return}o(v.pass===""),a(v)}catch{console.log("Error al cargar configuración")}},[]);const y=v=>{const{name:p,value:j}=v.target;a({...r,[p]:j})},R=async v=>{try{v.preventDefault();let p={ssid:!1,pass:!1,ip:!1,gateway:!1,fetch:!1};if(d===""&&(p={...p,ssid:!0}),l===""&&!t&&(p={...p,pass:!0}),c==="1"&&((u===""||!L.test(u))&&(p={...p,ip:!0}),(f===""||!L.test(f))&&(p={...p,gateway:!0})),!(p.ssid||p.pass||p.ip||p.gateway)){i({ssid:!1,pass:!1,ip:!1,gateway:!1,fetch:!1});let j=await J(r,n);if(j.status===401){m({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),b.current===null?b.current=setTimeout(()=>{m({text:"",type:""}),g(null),location.route("/config")},2e3):(clearTimeout(b.current),b.current=setTimeout(()=>{m({text:"",type:""}),g(null),location.route("/config")},2e3));return}j.status===200?m({text:"Cambios guardados exitosamente.",type:"success"}):m({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"})}i(p)}catch(p){console.log(p),m({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"})}};return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"flex border-b border-gray-200 dark:border-gray-700 p-6",children:[e("a",{href:"/configuracion",className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",children:e($,{})}),e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Red"})]}),e("form",{class:"p-6",onSubmit:R,children:[e("div",{className:"mb-5",children:[e("label",{for:"mode",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Seleccione modo de trabajo"}),e("select",{id:"mode",value:c,name:"mode",onChange:y,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[e("option",{value:"1",children:"Modo estación"}),e("option",{value:"2",children:"Punto de acceso"})]})]}),e("div",{class:"mb-5",children:[e("label",{for:"ssid",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre de la red"}),e("input",{type:"text",id:"ssid",class:s.ssid?P:I,required:!0,name:"ssid",onInput:y,value:d}),s.ssid&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),e("div",{class:"mb-5 flex items-center gap-5",children:[e("div",{className:"flex flex-col flex-1",children:[e("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Contraseña"}),e("input",{disabled:t,type:"password",id:"password",class:`disabled:cursor-not-allowed bg-gray-50 border  dark:disabled:bg-gray-800 dark:disabled:border-gray-700 dark:disable:placeholder-gray-500${s.pass?P:I}  `,name:"pass",onInput:y,value:l}),s.pass&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),e("label",{class:"flex cursor-pointer pt-5",children:[e("input",{type:"checkbox",value:"",class:"sr-only peer",onInput:()=>{o(v=>!v),y({target:{name:"pass",value:""}})}}),e("div",{class:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 dark:peer-focus:ring-green-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:w-5 after:h-5 after:transition-all dark:border-gray-600 peer-checked:bg-green-600"}),e("span",{class:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Sin contraseña"})]})]}),e("div",{class:"mb-5",children:[e("label",{for:"ip",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Dirección IP"}),e("input",{type:"text",id:"ip",class:s.ip?P:I,placeholder:"192.168.0.100",required:!0,name:"ip",onInput:y,value:u}),s.ip&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),c==="1"&&e(N,{children:e("div",{class:"mb-5",children:[e("label",{for:"gateway",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Puerta de enlace"}),e("input",{type:"text",id:"gateway",class:s.gateway?P:I,placeholder:"192.168.0.1",required:!0,name:"gateway",onInput:y,value:f}),s.gateway&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]})}),h.text&&e("p",{className:`text-sm text-center mb-4 ${h.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:h.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:R,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})}const Q=[2,5,10,15,30,60],X=[["GMT -3:00 Brasilia",-10800],["GMT -4:00 - Caracas",-14400],["GMT -5:00 - Bogotá",-18e3]],z="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",Y=async r=>await(await fetch(k+"config?seccion=datos",{headers:{Authorization:`Bearer ${r}`}})).json(),ee=async(r,a)=>{if(!a)return;let t=new FormData;return Object.keys(r).forEach(o=>{t.append(o,r[o])}),t.append("seccion","datos"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function re(){const[r,a]=x({p_muestreo:"5",z_horaria:"-14400"}),[t,o]=x({text:"",type:""}),s=S(null),{token:i,setToken:n}=C(T),{p_muestreo:g,z_horaria:h}=r;w(async()=>{try{a(await Y(i))}catch{console.log("Error al cargar configuración")}},[]),w(()=>()=>{s.current&&clearTimeout(s.current)},[]);const m=d=>{const{name:l,value:u}=d.target;a({...r,[l]:u})},b=async d=>{d.preventDefault();let l=await ee(r,i);l.status===200?o({text:"Cambios guardados exitosamente.",type:"success"}):l.status===401?(o({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),s.current===null?s.current=setTimeout(()=>{o({text:"",type:""}),n(null),location.route("/config")},2e3):(clearTimeout(s.current),s.current=setTimeout(()=>{o({text:"",type:""}),n(null),location.route("/config")},2e3))):o({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"})};return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"flex border-b border-gray-200 dark:border-gray-700 p-6",children:[e("a",{href:"/configuracion",className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",children:e($,{})}),e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Toma de datos"})]}),e("form",{class:"p-6",onSubmit:d=>{d.preventDefault(),b(d)},children:[e("div",{className:"mb-5",children:[e("label",{for:"p_muestreo",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Período de muestreo"}),e("select",{id:"p_muestreo",value:g,name:"p_muestreo",onChange:m,class:z,children:Q.map(d=>e("option",{value:d.toString(),children:`${d} minutos`},d))})]}),e("div",{className:"mb-5",children:[e("label",{for:"z_horaria",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Zona horaria"}),e("select",{id:"z_horaria",value:h,name:"z_horaria",onChange:m,class:z,children:X.map((d,l)=>e("option",{value:d[1],children:d[0]},l))})]}),t.text&&e("p",{className:`text-sm text-center mb-4 ${t.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:t.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:b,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})}const te={humedad:"Humedad",temperatura:"Temperatura",presion:"Presión",velocidad:"Velocidad del viento",pluviosidad:"Pluviosidad",solar:"Potencia panel solar"};function ae({alarm:r,updateAlarm:a,deleteAlarm:t}){const[o,s]=x(!1),[i,n]=x({bajo:r.bajo,alto:r.alto}),{variable:g,bajo:h,alto:m}=r;return e("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-4",children:e("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[e("span",{className:"font-semibold dark:text-white text-gray-900",children:te[g]}),e("div",{children:o?e(N,{children:e("input",{value:i.bajo,onChange:b=>n({...i,bajo:b.target.value}),type:"number",id:"low",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Bajo",required:!0})}):e(N,{children:[e("span",{className:"text-sm text-muted-foreground text-gray-500 dark:text-gray-400 ",children:["Bajo:"," "]}),e("span",{className:"font-medium text-gray-400 dark:text-gray-300",children:h})]})}),e("div",{children:o?e(N,{children:e("input",{value:i.alto,onChange:b=>n({...i,alto:b.target.value}),type:"number",id:"high",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Alto",required:!0})}):e(N,{children:[e("span",{className:"text-sm text-muted-foreground text-gray-500 dark:text-gray-400 ",children:["Alto:"," "]}),e("span",{className:"font-medium text-gray-400 dark:text-gray-300",children:m})]})}),e("div",{className:"flex gap-2",children:o?e(N,{children:[e("button",{onClick:()=>{a(g,i),s(!1)},type:"button",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800",children:"Guardar"}),e("button",{onClick:()=>s(!1),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",children:"Cancelar"})]}):e(N,{children:[e("button",{onClick:()=>s(!0),className:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 hover:bg-gray-900 h-10 w-10",children:e(H,{})}),e("button",{onClick:()=>t(g),className:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0  bg-red-500 text-white hover:bg-red-400 h-10 w-10",children:e(Z,{})})]})})]})})}const _="bg-red-50 border border-red-500 text-red-900 placeholder-red-700 text-sm rounded-lg focus:ring-red-500 dark:bg-gray-700 focus:border-red-500 block w-full p-2.5 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500",B="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",oe={humedad:"Humedad",temperatura:"Temperatura",presion:"Presión",velocidad:"Velocidad del viento",pluviosidad:"Pluviosidad",direccion:"Dirección del viento"};function se({variables:r,addAlarm:a}){const[t,o]=x({bajo:"",alto:"",variable:""}),[s,i]=x({alto:!1,bajo:!1,variable:!1});return e("div",{className:"mb-4 border-b border-gray-200 dark:border-gray-700 pt-4 pb-6",children:[e("h3",{className:"text-lg mb-4 font-semibold text-gray-400 dark:text-gray-300",children:"Crear alarma"}),e("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e("div",{children:[e("label",{for:"countries",class:"block mb-1 text-sm font-medium text-gray-900 dark:text-white",children:"Variable"}),e("select",{value:t.variable,onChange:n=>o({...t,variable:n.target.value}),id:"countries",class:`bg-gray-50 border ${s.variable?"text-red-500 border-red-500 dark:border-red-500 dark:text-red-500":"text-gray-900 border-gray-300 dark:border-gray-600 dark:text-white"}  text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700  dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500`,children:[e("option",{value:"",selected:!0,children:"Seleciona una variable"}),r.map(n=>e("option",{value:n,children:oe[n]}))]})]}),e("div",{children:[e("label",{for:"low-new",class:"block mb-1 text-sm font-medium text-gray-900 dark:text-white",children:"Limite inferior"}),e("input",{value:t.bajo,onChange:n=>o({...t,bajo:n.target.value}),type:"number",id:"low-new",class:s.bajo?_:B,placeholder:"Ingrese valor",required:!0,step:"any"})]}),e("div",{children:[e("label",{for:"high-new",class:"block mb-1 text-sm font-medium text-gray-900 dark:text-white",children:"Limite superior"}),e("input",{value:t.alto,onChange:n=>o({...t,alto:n.target.value}),type:"number",id:"high-new",class:s.alto?_:B,placeholder:"Ingrese valor",required:!0,step:"any"})]})]}),e("div",{className:"mt-4",children:e("button",{onClick:()=>{const{alto:n,bajo:g,variable:h}=t;let m=g===""||g>=n,b=n===""||n<=g,d=h==="";!m&&!b&&(console.log(t),a(t),o({bajo:"",alto:"",variable:""})),i({alto:b,bajo:m,variable:d})},type:"button",class:"focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Crear alarma"})})]})}const ne=["temperatura","presion","humedad","velocidad","pluviosidad","solar"],le=async r=>await(await fetch(k+"config?seccion=alarmas",{headers:{Authorization:`Bearer ${r}`}})).json(),de=async(r,a)=>{if(!a)return;let t=new FormData;return r.forEach(o=>{t.append(`${o.variable}_bajo`,o.bajo),t.append(`${o.variable}_alto`,o.alto)}),t.append("seccion","alarmas"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function ie(){const[r,a]=x([]),[t,o]=x({text:"",type:""}),{token:s,setToken:i}=C(T),n=S(null);w(async()=>{try{a(await le(s))}catch{console.log("Error al cargar configuración")}},[]),w(()=>()=>{n.current&&clearTimeout(n.current)},[]);const g=async l=>{l.preventDefault();let u=await de(r,s);if(u.status===200)o({text:"Cambios guardados exitosamente.",type:"success"});else if(u.status===401){o({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),n.current===null?n.current=setTimeout(()=>{o({text:"",type:""}),i(null),location.route("/config")},2e3):(clearTimeout(n.current),n.current=setTimeout(()=>{o({text:"",type:""}),i(null),location.route("/config")},2e3));return}else o({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"})},h=(l,u)=>{a(f=>f.map(c=>c.variable===l?{...c,...u}:c))},m=l=>{a(u=>[...u,l])},b=l=>{a(u=>u.filter(f=>f.variable!==l))},d=ne.filter(l=>!r.map(u=>u.variable).includes(l));return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:e("div",{className:"flex flex-col",children:[e("div",{className:"border-b border-gray-200 dark:border-gray-700 p-6",children:e("div",{className:"flex items-start",children:[e("a",{className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",href:"/configuracion",children:e($,{})}),e("div",{className:"flex flex-col",children:[e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Alarmas"}),e("p",{class:"text-md font-normal text-gray-500 lg:text-lg dark:text-gray-400",children:"Crea y modifica alarmas"})]})]})}),e("div",{className:"p-6",children:[e(se,{variables:d,addAlarm:m}),e("div",{className:"flex flex-col gap-y-3 py-4",children:[e("h3",{className:"text-lg mb-4 font-semibold text-gray-400 dark:text-gray-300",children:"Alarmas existentes"}),Object.keys(r).map(l=>e(ae,{alarm:{variable:l,...r[l]},updateAlarm:h,deleteAlarm:b},l))]}),t.text&&e("p",{className:`text-sm text-center mb-4 ${t.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:t.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:g,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})})}const ce=async r=>{if(!r)return;let a=new FormData;return a.append("seccion","reset"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(a),headers:{Authorization:`Bearer ${r}`}})};function ue(){const[r,a]=x({text:"",type:""}),{token:t,setToken:o}=C(T),s=S(null);return w(()=>()=>{s.current&&clearTimeout(s.current)},[]),e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"flex items-start border-b border-gray-200 dark:border-gray-700 p-6",children:[e("a",{className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",href:"/configuracion",children:e($,{})}),e("div",{className:"flex flex-col",children:[e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Restablecer dispositivo"}),e("p",{class:"text-md font-normal text-gray-500 lg:text-lg dark:text-gray-400 mb-4",children:["Restablecer el dispositivo. ",e("br",{}),"Esto eliminara toda la configuración y datos existentes."]})]})]}),e("div",{className:"flex flex-col justify-center p-6",children:[e("button",{onClick:async n=>{n.preventDefault();const g=await ce(t);if(g.status===200){a({text:"El dispositivo se está restableciendo",type:"success"}),s.current=setTimeout(()=>{window.location.reload()},3e3);return}else if(g.status===401){a({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),s.current===null?s.current=setTimeout(()=>{a({text:"",type:""}),o(null),location.route("/config")},2e3):(clearTimeout(s.current),s.current=setTimeout(()=>{a({text:"",type:""}),o(null),location.route("/config")},2e3));return}else{a({text:"Error al restablecer el dispositivo. Inténtelo de nuevo.",type:"error"});return}},type:"button",class:"focus:outline-none text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900",children:"Restablecer"}),r.text&&e("div",{className:"flex justify-center p-6",children:e("p",{className:`text-sm text-center ${r.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:r.text})})]})]})}const D="bg-red-50 border border-red-500 text-red-900 placeholder-red-700 text-sm rounded-lg focus:ring-red-500 dark:bg-gray-700 focus:border-red-500 block w-full p-2.5 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500",E="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",ge=async r=>await(await fetch(k+"config?seccion=calibracion",{headers:{Authorization:`Bearer ${r}`}})).json(),me=async(r,a)=>{if(!a)return;let t=new FormData;return Object.keys(r).forEach(o=>{t.append(o,r[o])}),t.append("seccion","calibracion"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function be(){const[r,a]=x({solar:"",anemometro:"",pluviometro:""}),[t,o]=x({solar:!1,anemometro:!1,pluviometro:!1}),[s,i]=x({text:"",type:""}),{token:n,setToken:g}=C(T),{solar:h,anemometro:m,pluviometro:b}=r,d=S(null);w(async()=>{try{a(await ge(n))}catch{console.log("Error al cargar configuración")}},[]);const l=f=>{const{name:c,value:y}=f.target;a({...r,[c]:y})},u=async f=>{f.preventDefault();let c={solar:!1,anemometro:!1,pluviometro:!1};if(h===""&&(c={...c,solar:!0}),m===""&&(c={...c,anemometro:!0}),b===""&&(c={...c,pluviometro:!0}),!(c.solar||c.anemometro||c.pluviometro)){o({solar:!1,anemometro:!1,pluviometro:!1});let y=await me(r,n);if(y.status===200)i({text:"Cambios guardados exitosamente.",type:"success"});else if(y.status===401){i({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),d.current===null?d.current=setTimeout(()=>{i({text:"",type:""}),g(null),location.route("/config")},2e3):(clearTimeout(d.current),d.current=setTimeout(()=>{i({text:"",type:""}),g(null),location.route("/config")},2e3));return}else i({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"});return 0}o(c)};return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"flex p-6 border-b border-gray-200 dark:border-gray-700",children:[e("a",{className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",href:"/configuracion",children:e($,{})}),e("h2",{className:"text-3xl font-bold dark:text-white mb-2",children:"Calibración"})]}),e("form",{onSubmit:u,className:"p-6",children:[e("div",{class:"mb-5",children:[e("label",{for:"solar",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Potencia del panel solar"}),e("input",{type:"number",id:"solar",class:t.solar?D:E,required:!0,name:"solar",onInput:l,value:h}),t.solar&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),e("div",{class:"mb-5",children:[e("label",{for:"anemometro",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Anemómetro"}),e("input",{type:"number",id:"anemometro",class:t.anemometro?D:E,required:!0,name:"anemometro",onInput:l,value:m}),t.anemometro&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),e("div",{class:"mb-5",children:[e("label",{for:"pluviometro",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Pluviómetro"}),e("input",{type:"number",id:"pluviometro",class:t.pluviometro?D:E,required:!0,name:"pluviometro",onInput:l,value:b}),t.pluviometro&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),s.text&&e("p",{className:`text-sm text-center mb-4 ${s.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:s.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:u,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})}const M="bg-red-50 border border-red-500 text-red-900 placeholder-red-700 text-sm rounded-lg focus:ring-red-500 dark:bg-gray-700 focus:border-red-500 block w-full p-2.5 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500",F="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",fe=async r=>await(await fetch(k+"config?seccion=servidor",{headers:{Authorization:`Bearer ${r}`}})).json(),he=async(r,a)=>{if(!a)return;let t=new FormData;return Object.keys(r).forEach(o=>{t.append(o,r[o])}),t.append("seccion","servidor"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function xe(){const[r,a]=x({url:"",puerto:""}),[t,o]=x({url:!1}),[s,i]=x({text:"",type:""}),{token:n,setToken:g}=C(T),h=S(null),{url:m,puerto:b}=r;w(async()=>{try{a(await fe(n))}catch{console.log("Error al cargar configuración")}},[]),w(()=>()=>{h.current&&clearTimeout(h.current)},[]);const d=u=>{const{name:f,value:c}=u.target;a({...r,[f]:c})},l=async u=>{u.preventDefault();let f={url:!1,puerto:!1};if(m===""&&(f={...f,url:!0}),b!==""&&isNaN(b)&&(f={...f,puerto:!0}),!f.url&&!f.puerto){o({url:!1,puerto:!1});let c=await he(r,n);return c.status===200?i({text:"Cambios guardados exitosamente.",type:"success"}):c.status===401?h.current===null?h.current=setTimeout(()=>{i({text:"",type:""}),g(null),location.route("/config")},2e3):(clearTimeout(h.current),h.current=setTimeout(()=>{i({text:"",type:""}),g(null),location.route("/config")},2e3)):i({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"}),0}o(f)};return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"border-b border-gray-200 dark:border-gray-700 p-6",children:e("div",{className:"flex items-start",children:[e("a",{className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",href:"/configuracion",children:e($,{})}),e("div",{className:"flex flex-col",children:[e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Servidor externo"}),e("p",{class:"text-md font-normal text-gray-500 lg:text-lg dark:text-gray-400",children:"Conexión al servidor externo"})]})]})}),e("form",{onSubmit:l,className:"p-6",children:[e("div",{className:"flex flex-col md:flex-row gap-0 md:gap-6 mb-5",children:[e("div",{class:"flex-1",children:[e("label",{for:"url",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"URL"}),e("input",{type:"text",id:"url",class:t.url?M:F,required:!0,name:"url",onInput:d,value:m}),t.url&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),e("div",{class:"flex-1",children:[e("label",{for:"puerto",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Puerto"}),e("input",{type:"text",id:"puerto",placeholder:"Ej: 3000",class:t.puerto?M:F,name:"puerto",onInput:d,value:b}),t.puerto&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]})]}),s.text&&e("p",{className:`text-sm text-center mb-4 ${s.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:s.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:l,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})}const O={wifi:K,data:re,alarmas:ie,reset:ue,calibracion:be,servidor:xe};function pe(){const{token:r}=C(T),a=q();return w(()=>{r||a.route("/configuracion")},[r]),e("div",{className:"",children:e(G,{children:e(U,{children:Object.keys(O).map(t=>e(V,{path:`/${t}`,component:O[t]}))})})})}function ke(){return e(pe,{})}export{ke as default};
