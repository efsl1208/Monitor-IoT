import{c as A,h,d as N,e as C,a as S,y as v,u as e,b as w,B as k,f as F,E as O,g as q,i as G}from"./index-B8iF0beH.js";/**
 * @license lucide-preact v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=A("MoveLeft",[["path",{d:"M6 8L2 12L6 16",key:"kyvwex"}],["path",{d:"M2 12H22",key:"1m8cig"}]]);/**
 * @license lucide-preact v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=A("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-preact v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=A("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),L=/^((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)\.?\b){4}$/,P="bg-red-50 border border-red-500 text-red-900 placeholder-red-700 text-sm rounded-lg focus:ring-red-500 dark:bg-gray-700 focus:border-red-500 block w-full p-2.5 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500",D="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",H=async r=>await(await fetch(k+"config?seccion=red",{headers:{Authorization:`Bearer ${r}`}})).json(),Z=async(r,a)=>{if(!a)return;let t=new FormData;return Object.keys(r).forEach(o=>{t.append(o,r[o])}),t.append("seccion","red"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function W(){const[r,a]=h({mode:"1",ssid:"",pass:"",ip:"",gateway:""}),[t,o]=h(!1),[s,i]=h({ssid:!1,pass:!1,ip:!1,gateway:!1,fetch:!1}),{token:n,setToken:u}=N(C),[m,g]=h({text:"",type:""}),b=S(null),{ssid:d,pass:l,ip:c,gateway:x,mode:f}=r;v(async()=>{try{a(await H(n))}catch{console.log("Error al cargar configuración")}},[]);const y=T=>{const{name:p,value:j}=T.target;a({...r,[p]:j})},R=async T=>{try{T.preventDefault();let p={ssid:!1,pass:!1,ip:!1,gateway:!1,fetch:!1};if(d===""&&(p={...p,ssid:!0}),l===""&&!t&&(p={...p,pass:!0}),f==="1"&&((c===""||!L.test(c))&&(p={...p,ip:!0}),(x===""||!L.test(x))&&(p={...p,gateway:!0})),!(p.ssid||p.pass||p.ip||p.gateway)){i({ssid:!1,pass:!1,ip:!1,gateway:!1,fetch:!1});let j=await Z(r,n);if(j.status===401){g({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),b.current===null?b.current=setTimeout(()=>{g({text:"",type:""}),u(null),location.route("/config")},2e3):(clearTimeout(b.current),b.current=setTimeout(()=>{g({text:"",type:""}),u(null),location.route("/config")},2e3));return}j.status===200?g({text:"Cambios guardados exitosamente.",type:"success"}):g({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"})}i(p)}catch(p){console.log(p),g({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"})}};return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"flex border-b border-gray-200 dark:border-gray-700 p-6",children:[e("a",{href:"/configuracion",className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",children:e($,{})}),e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Red"})]}),e("form",{class:"p-6",onSubmit:R,children:[e("div",{className:"mb-5",children:[e("label",{for:"mode",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Seleccione modo de trabajo"}),e("select",{id:"mode",value:f,name:"mode",onChange:y,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[e("option",{value:"1",children:"Modo estación"}),e("option",{value:"2",children:"Punto de acceso"})]})]}),e("div",{class:"mb-5",children:[e("label",{for:"ssid",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre de la red"}),e("input",{type:"text",id:"ssid",class:s.ssid?P:D,required:!0,name:"ssid",onInput:y,value:d}),s.ssid&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),e("div",{class:"mb-5 flex items-center gap-5",children:[e("div",{className:"flex flex-col flex-1",children:[e("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Contraseña"}),e("input",{disabled:t,type:"password",id:"password",class:`disabled:cursor-not-allowed bg-gray-50 border  dark:disabled:bg-gray-800 dark:disabled:border-gray-700 dark:disable:placeholder-gray-500${s.pass?P:D}  `,name:"pass",onInput:y,value:l}),s.pass&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),e("label",{class:"flex cursor-pointer pt-5",children:[e("input",{type:"checkbox",value:"",class:"sr-only peer",onInput:()=>{o(T=>!T),y({target:{name:"pass",value:""}})}}),e("div",{class:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 dark:peer-focus:ring-green-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:w-5 after:h-5 after:transition-all dark:border-gray-600 peer-checked:bg-green-600"}),e("span",{class:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Sin contraseña"})]})]}),e("div",{class:"mb-5",children:[e("label",{for:"ip",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Dirección IP"}),e("input",{type:"text",id:"ip",class:s.ip?P:D,placeholder:"192.168.0.100",required:!0,name:"ip",onInput:y,value:c}),s.ip&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),f==="1"&&e(w,{children:e("div",{class:"mb-5",children:[e("label",{for:"gateway",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Puerta de enlace"}),e("input",{type:"text",id:"gateway",class:s.gateway?P:D,placeholder:"192.168.0.1",required:!0,name:"gateway",onInput:y,value:x}),s.gateway&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]})}),m.text&&e("p",{className:`text-sm text-center mb-4 ${m.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:m.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:R,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})}const J=[2,5,10,15,30,60],K=[["GMT -3:00 Brasilia",-10800],["GMT -4:00 - Caracas",-14400],["GMT -5:00 - Bogotá",-18e3]],z="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",Q=async r=>await(await fetch(k+"config?seccion=datos",{headers:{Authorization:`Bearer ${r}`}})).json(),X=async(r,a)=>{if(!a)return;let t=new FormData;return Object.keys(r).forEach(o=>{t.append(o,r[o])}),t.append("seccion","datos"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function Y(){const[r,a]=h({p_muestreo:"5",z_horaria:"-14400"}),[t,o]=h({text:"",type:""}),s=S(null),{token:i,setToken:n}=N(C),{p_muestreo:u,z_horaria:m}=r;v(async()=>{try{a(await Q(i))}catch{console.log("Error al cargar configuración")}},[]),v(()=>()=>{s.current&&clearTimeout(s.current)},[]);const g=d=>{const{name:l,value:c}=d.target;a({...r,[l]:c})},b=async d=>{d.preventDefault();let l=await X(r,i);l.status===200?o({text:"Cambios guardados exitosamente.",type:"success"}):l.status===401?(o({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),s.current===null?s.current=setTimeout(()=>{o({text:"",type:""}),n(null),location.route("/config")},2e3):(clearTimeout(s.current),s.current=setTimeout(()=>{o({text:"",type:""}),n(null),location.route("/config")},2e3))):o({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"})};return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"flex border-b border-gray-200 dark:border-gray-700 p-6",children:[e("a",{href:"/configuracion",className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",children:e($,{})}),e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Toma de datos"})]}),e("form",{class:"p-6",onSubmit:d=>{d.preventDefault(),b(d)},children:[e("div",{className:"mb-5",children:[e("label",{for:"p_muestreo",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Período de muestreo"}),e("select",{id:"p_muestreo",value:u,name:"p_muestreo",onChange:g,class:z,children:J.map(d=>e("option",{value:d.toString(),children:`${d} minutos`},d))})]}),e("div",{className:"mb-5",children:[e("label",{for:"z_horaria",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Zona horaria"}),e("select",{id:"z_horaria",value:m,name:"z_horaria",onChange:g,class:z,children:K.map((d,l)=>e("option",{value:d[1],children:d[0]},l))})]}),t.text&&e("p",{className:`text-sm text-center mb-4 ${t.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:t.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:b,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})}const ee={humedad:"Humedad",temperatura:"Temperatura",presion:"Presión",velocidad:"Velocidad del viento",pluviosidad:"Pluviosidad",solar:"Potencia panel solar"};function re({alarm:r,updateAlarm:a,deleteAlarm:t}){const[o,s]=h(!1),[i,n]=h({bajo:r.bajo,alto:r.alto}),{variable:u,bajo:m,alto:g}=r;return e("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-4",children:e("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[e("span",{className:"font-semibold dark:text-white text-gray-900",children:ee[u]}),e("div",{children:o?e(w,{children:e("input",{value:i.bajo,onChange:b=>n({...i,bajo:b.target.value}),type:"number",id:"low",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Bajo",required:!0})}):e(w,{children:[e("span",{className:"text-sm text-muted-foreground text-gray-500 dark:text-gray-400 ",children:["Bajo:"," "]}),e("span",{className:"font-medium text-gray-400 dark:text-gray-300",children:m})]})}),e("div",{children:o?e(w,{children:e("input",{value:i.alto,onChange:b=>n({...i,alto:b.target.value}),type:"number",id:"high",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Alto",required:!0})}):e(w,{children:[e("span",{className:"text-sm text-muted-foreground text-gray-500 dark:text-gray-400 ",children:["Alto:"," "]}),e("span",{className:"font-medium text-gray-400 dark:text-gray-300",children:g})]})}),e("div",{className:"flex gap-2",children:o?e(w,{children:[e("button",{onClick:()=>{a(u,i),s(!1)},type:"button",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800",children:"Guardar"}),e("button",{onClick:()=>s(!1),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",children:"Cancelar"})]}):e(w,{children:[e("button",{onClick:()=>s(!0),className:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 hover:bg-gray-900 h-10 w-10",children:e(U,{})}),e("button",{onClick:()=>t(u),className:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0  bg-red-500 text-white hover:bg-red-400 h-10 w-10",children:e(V,{})})]})})]})})}const _="bg-red-50 border border-red-500 text-red-900 placeholder-red-700 text-sm rounded-lg focus:ring-red-500 dark:bg-gray-700 focus:border-red-500 block w-full p-2.5 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500",B="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",te={humedad:"Humedad",temperatura:"Temperatura",presion:"Presión",velocidad:"Velocidad del viento",pluviosidad:"Pluviosidad",direccion:"Dirección del viento"};function ae({variables:r,addAlarm:a}){const[t,o]=h({bajo:"",alto:"",variable:""}),[s,i]=h({alto:!1,bajo:!1,variable:!1});return e("div",{className:"mb-4 border-b border-gray-200 dark:border-gray-700 pt-4 pb-6",children:[e("h3",{className:"text-lg mb-4 font-semibold text-gray-400 dark:text-gray-300",children:"Crear alarma"}),e("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e("div",{children:[e("label",{for:"countries",class:"block mb-1 text-sm font-medium text-gray-900 dark:text-white",children:"Variable"}),e("select",{value:t.variable,onChange:n=>o({...t,variable:n.target.value}),id:"countries",class:`bg-gray-50 border ${s.variable?"text-red-500 border-red-500 dark:border-red-500 dark:text-red-500":"text-gray-900 border-gray-300 dark:border-gray-600 dark:text-white"}  text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700  dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500`,children:[e("option",{value:"",selected:!0,children:"Seleciona una variable"}),r.map(n=>e("option",{value:n,children:te[n]}))]})]}),e("div",{children:[e("label",{for:"low-new",class:"block mb-1 text-sm font-medium text-gray-900 dark:text-white",children:"Limite inferior"}),e("input",{value:t.bajo,onChange:n=>o({...t,bajo:n.target.value}),type:"number",id:"low-new",class:s.bajo?_:B,placeholder:"Ingrese valor",required:!0,step:"any"})]}),e("div",{children:[e("label",{for:"high-new",class:"block mb-1 text-sm font-medium text-gray-900 dark:text-white",children:"Limite superior"}),e("input",{value:t.alto,onChange:n=>o({...t,alto:n.target.value}),type:"number",id:"high-new",class:s.alto?_:B,placeholder:"Ingrese valor",required:!0,step:"any"})]})]}),e("div",{className:"mt-4",children:e("button",{onClick:()=>{const{alto:n,bajo:u,variable:m}=t;let g=u===""||u>=n,b=n===""||n<=u,d=m==="";!g&&!b&&(console.log(t),a(t),o({bajo:"",alto:"",variable:""})),i({alto:b,bajo:g,variable:d})},type:"button",class:"focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Crear alarma"})})]})}const oe=["temperatura","presion","humedad","velocidad","pluviosidad","solar"],se=async r=>await(await fetch(k+"config?seccion=alarmas",{headers:{Authorization:`Bearer ${r}`}})).json(),ne=async(r,a)=>{if(!a)return;let t=new FormData;return r.forEach(o=>{t.append(`${o.variable}_bajo`,o.bajo),t.append(`${o.variable}_alto`,o.alto)}),t.append("seccion","alarmas"),console.log(t),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function le(){const[r,a]=h([]),[t,o]=h({text:"",type:""}),{token:s,setToken:i}=N(C),n=S(null);v(async()=>{try{a(await se(s))}catch{console.log("Error al cargar configuración")}},[]),v(()=>()=>{n.current&&clearTimeout(n.current)},[]);const u=async l=>{l.preventDefault();let c=await ne(r,s);if(c.status===200)o({text:"Cambios guardados exitosamente.",type:"success"});else if(c.status===401){o({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),n.current===null?n.current=setTimeout(()=>{o({text:"",type:""}),i(null),location.route("/config")},2e3):(clearTimeout(n.current),n.current=setTimeout(()=>{o({text:"",type:""}),i(null),location.route("/config")},2e3));return}else o({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"})},m=(l,c)=>{a(x=>x.map(f=>f.variable===l?{...f,...c}:f))},g=l=>{a(c=>[...c,l])},b=l=>{a(c=>c.filter(x=>x.variable!==l))},d=oe.filter(l=>!r.map(c=>c.variable).includes(l));return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:e("div",{className:"flex flex-col",children:[e("div",{className:"border-b border-gray-200 dark:border-gray-700 p-6",children:e("div",{className:"flex items-start",children:[e("a",{className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",href:"/configuracion",children:e($,{})}),e("div",{className:"flex flex-col",children:[e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Alarmas"}),e("p",{class:"text-md font-normal text-gray-500 lg:text-lg dark:text-gray-400",children:"Crea y modifica alarmas"})]})]})}),e("div",{className:"p-6",children:[e(ae,{variables:d,addAlarm:g}),e("div",{className:"flex flex-col gap-y-3 py-4",children:[e("h3",{className:"text-lg mb-4 font-semibold text-gray-400 dark:text-gray-300",children:"Alarmas existentes"}),Object.keys(r).map(l=>e(re,{alarm:{variable:l,...r[l]},updateAlarm:m,deleteAlarm:b},l))]}),t.text&&e("p",{className:`text-sm text-center mb-4 ${t.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:t.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:u,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})})}const de=async r=>{if(!r)return;let a=new FormData;return a.append("seccion","reset"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(a),headers:{Authorization:`Bearer ${r}`}})};function ie(){const[r,a]=h({text:"",type:""}),{token:t,setToken:o}=N(C),s=S(null);return v(()=>()=>{s.current&&clearTimeout(s.current)},[]),e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"flex items-start border-b border-gray-200 dark:border-gray-700 p-6",children:[e("a",{className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",href:"/configuracion",children:e($,{})}),e("div",{className:"flex flex-col",children:[e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Restablecer dispositivo"}),e("p",{class:"text-md font-normal text-gray-500 lg:text-lg dark:text-gray-400 mb-4",children:["Restablecer el dispositivo. ",e("br",{}),"Esto eliminara toda la configuración y datos existentes."]})]})]}),e("div",{className:"flex flex-col justify-center p-6",children:[e("button",{onClick:async n=>{n.preventDefault();const u=await de(t);if(u.status===200){a({text:"El dispositivo se está restableciendo",type:"success"}),s.current=setTimeout(()=>{window.location.reload()},3e3);return}else if(u.status===401){a({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),s.current===null?s.current=setTimeout(()=>{a({text:"",type:""}),o(null),location.route("/config")},2e3):(clearTimeout(s.current),s.current=setTimeout(()=>{a({text:"",type:""}),o(null),location.route("/config")},2e3));return}else{a({text:"Error al restablecer el dispositivo. Inténtelo de nuevo.",type:"error"});return}},type:"button",class:"focus:outline-none text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900",children:"Restablecer"}),r.text&&e("div",{className:"flex justify-center p-6",children:e("p",{className:`text-sm text-center ${r.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:r.text})})]})]})}const E="bg-red-50 border border-red-500 text-red-900 placeholder-red-700 text-sm rounded-lg focus:ring-red-500 dark:bg-gray-700 focus:border-red-500 block w-full p-2.5 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500",I="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",ce=async r=>await(await fetch(k+"config?seccion=calibracion",{headers:{Authorization:`Bearer ${r}`}})).json(),ue=async(r,a)=>{if(!a)return;let t=new FormData;return Object.keys(r).forEach(o=>{t.append(o,r[o])}),t.append("seccion","calibracion"),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function ge(){const[r,a]=h({solar:"",anemometro:"",pluviometro:""}),[t,o]=h({solar:!1,anemometro:!1,pluviometro:!1}),[s,i]=h({text:"",type:""}),{token:n,setToken:u}=N(C),{solar:m,anemometro:g,pluviometro:b}=r,d=S(null);v(async()=>{try{a(await ce(n))}catch{console.log("Error al cargar configuración")}},[]);const l=x=>{const{name:f,value:y}=x.target;a({...r,[f]:y})},c=async x=>{x.preventDefault();let f={solar:!1,anemometro:!1,pluviometro:!1};if(m===""&&(f={...f,solar:!0}),g===""&&(f={...f,anemometro:!0}),b===""&&(f={...f,pluviometro:!0}),!(f.solar||f.anemometro||f.pluviometro)){o({solar:!1,anemometro:!1,pluviometro:!1});let y=await ue(r,n);if(y.status===200)i({text:"Cambios guardados exitosamente.",type:"success"});else if(y.status===401){i({text:"La sesión ha expirado. Por favor, inicie sesión nuevamente.",type:"error"}),d.current===null?d.current=setTimeout(()=>{i({text:"",type:""}),u(null),location.route("/config")},2e3):(clearTimeout(d.current),d.current=setTimeout(()=>{i({text:"",type:""}),u(null),location.route("/config")},2e3));return}else i({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"});return 0}o(f)};return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"flex p-6 border-b border-gray-200 dark:border-gray-700",children:[e("a",{className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",href:"/configuracion",children:e($,{})}),e("h2",{className:"text-3xl font-bold dark:text-white mb-2",children:"Calibración"})]}),e("form",{onSubmit:c,className:"p-6",children:[e("div",{class:"mb-5",children:[e("label",{for:"solar",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Potencia del panel solar"}),e("input",{type:"number",id:"solar",class:t.solar?E:I,required:!0,name:"solar",onInput:l,value:m}),t.solar&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),e("div",{class:"mb-5",children:[e("label",{for:"anemometro",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Anemómetro"}),e("input",{type:"number",id:"anemometro",class:t.anemometro?E:I,required:!0,name:"anemometro",onInput:l,value:g}),t.anemometro&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),e("div",{class:"mb-5",children:[e("label",{for:"pluviometro",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Pluviómetro"}),e("input",{type:"number",id:"pluviometro",class:t.pluviometro?E:I,required:!0,name:"pluviometro",onInput:l,value:b}),t.pluviometro&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]}),s.text&&e("p",{className:`text-sm text-center mb-4 ${s.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:s.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:c,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})}const me="bg-red-50 border border-red-500 text-red-900 placeholder-red-700 text-sm rounded-lg focus:ring-red-500 dark:bg-gray-700 focus:border-red-500 block w-full p-2.5 dark:text-red-500 dark:placeholder-red-500 dark:border-red-500",be="bg-gray-50 border border-gray-300 dark:border-gray-600 text-gray-900 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",fe=async r=>await(await fetch(k+"config?seccion=servidor",{headers:{Authorization:`Bearer ${r}`}})).json(),he=async(r,a)=>{if(!a)return;let t=new FormData;return Object.keys(r).forEach(o=>{t.append(o,r[o])}),t.append("seccion","servidor"),console.log(t),await fetch(k+"config",{method:"POST",body:new URLSearchParams(t),headers:{Authorization:`Bearer ${a}`}})};function xe(){const[r,a]=h({url:""}),[t,o]=h({url:!1}),[s,i]=h({text:"",type:""}),{token:n,setToken:u}=N(C),m=S(null),{url:g}=r;v(async()=>{try{a(await fe(n))}catch{console.log("Error al cargar configuración")}},[]),v(()=>()=>{m.current&&clearTimeout(m.current)},[]);const b=l=>{const{name:c,value:x}=l.target;a({...r,[c]:x})},d=async l=>{l.preventDefault();let c={url:!1};if(g===""&&(c={...c,url:!0}),!c.url){o({url:!1});let x=await he(r,n);return x.status===200?i({text:"Cambios guardados exitosamente.",type:"success"}):x.status===401?m.current===null?m.current=setTimeout(()=>{i({text:"",type:""}),u(null),location.route("/config")},2e3):(clearTimeout(m.current),m.current=setTimeout(()=>{i({text:"",type:""}),u(null),location.route("/config")},2e3)):i({text:"Error al guardar los cambios. Inténtelo de nuevo.",type:"error"}),0}o(c)};return e("div",{className:"max-w-lg mx-auto rounded-lg border border-gray-200 dark:border-gray-700 mt-6",children:[e("div",{className:"border-b border-gray-200 dark:border-gray-700 p-6",children:e("div",{className:"flex items-start",children:[e("a",{className:"text-gray-600 dark:text-gray-600 mr-5 p-2 rounded-full hover:bg-slate-200 transition-colors",href:"/configuracion",children:e($,{})}),e("div",{className:"flex flex-col",children:[e("h2",{class:"text-3xl font-bold dark:text-white mb-2",children:"Servidor externo"}),e("p",{class:"text-md font-normal text-gray-500 lg:text-lg dark:text-gray-400",children:"Conexión al servidor externo"})]})]})}),e("form",{onSubmit:d,className:"p-6",children:[e("div",{className:"flex flex-col md:flex-row gap-0 md:gap-6 mb-5",children:e("div",{class:"flex-1",children:[e("label",{for:"url",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"URL"}),e("input",{type:"text",id:"url",class:t.url?me:be,required:!0,name:"url",onInput:b,value:g}),t.url&&e("p",{class:"mt-2 text-sm text-red-600 dark:text-red-500",children:e("span",{class:"font-medium",children:"Ingrese un valor válido."})})]})}),s.text&&e("p",{className:`text-sm text-center mb-4 ${s.type==="success"?"text-green-600 dark:text-green-500":"text-red-600 dark:text-red-500"}`,children:s.text}),e("div",{className:"flex justify-end",children:e("button",{onClick:d,class:"font-semibold focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",children:"Guardar cambios"})})]})]})}const M={wifi:W,data:Y,alarmas:le,reset:ie,calibracion:ge,servidor:xe};function pe(){const{token:r}=N(C),a=F();return console.log(r),v(()=>{r||a.route("/configuracion")},[r]),e("div",{className:"",children:e(O,{children:e(q,{children:Object.keys(M).map(t=>e(G,{path:`/${t}`,component:M[t]}))})})})}function ke(){return e(pe,{})}export{ke as default};
